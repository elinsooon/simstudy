<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ordinal Categorical Data • simstudy</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Ordinal Categorical Data">
<meta property="og:description" content="simstudy">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simstudy</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.2.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/simstudy.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/clustered.html">Clustered Data</a>
    </li>
    <li>
      <a href="../articles/correlated.html">Correlated Data</a>
    </li>
    <li>
      <a href="../articles/double_dot_extension.html">Dynamic Data Definition</a>
    </li>
    <li>
      <a href="../articles/longitudinal.html">Longitudinal Data</a>
    </li>
    <li>
      <a href="../articles/missing.html">Missing Data</a>
    </li>
    <li>
      <a href="../articles/ordinal.html">Ordinal Categorical Data</a>
    </li>
    <li>
      <a href="../articles/spline.html">Spline Data</a>
    </li>
    <li>
      <a href="../articles/survival.html">Survival Data</a>
    </li>
    <li>
      <a href="../articles/treat_and_exposure.html">Treatment and Exposure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kgoldfeld/simstudy/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ordinal_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ordinal Categorical Data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kgoldfeld/simstudy/blob/master/vignettes/ordinal.Rmd"><code>vignettes/ordinal.Rmd</code></a></small>
      <div class="hidden name"><code>ordinal.Rmd</code></div>

    </div>

    
    
<p>Using the <code>defData</code> and <code>genData</code> functions, it is relatively easy to specify multinomial distributions that characterize categorical data. Order becomes relevant when the categories take on meanings related to strength of opinion or agreement (as in a Likert-type response) or frequency. A motivating example could be when a response variable takes on five possible values: (1) strongly disagree, (2) disagree, (3) neutral, (4) agree, (5) strongly agree. There is a natural order to the response possibilities.</p>
<p>It is common to summarize the data by looking at <em>cumulative</em> probabilities, odds, or log-odds. Comparisons of different exposures or individual characteristics typically look at how these cumulative measures vary across the different exposures or characteristics. So, if we were interested in cumulative odds, we would compare <span class="math display">\[\small{\frac{P(response = 1|exposed)}{P(response &gt; 1|exposed)} \ \ vs. \ \frac{P(response = 1|unexposed)}{P(response &gt; 1|unexposed)}},\]</span></p>
<p><span class="math display">\[\small{\frac{P(response \le 2|exposed)}{P(response &gt; 2|exposed)} \ \ vs. \ \frac{P(response \le 2|unexposed)}{P(response &gt; 2|unexposed)}},\]</span></p>
<p>and continue until the last (in this case, fourth) comparison</p>
<p><span class="math display">\[\small{\frac{P(response \le 4|exposed)}{P(response &gt; 4|exposed)} \ \ vs. \ \frac{P(response \le 4|unexposed)}{P(response &gt; 4|unexposed)}},\]</span></p>
<p>We can use an underlying (continuous) latent process as the basis for data generation. If we assume that probabilities are determined by segments of a logistic distribution (see below), we can define the ordinal mechanism using thresholds along the support of the distribution. If there are <span class="math inline">\(k\)</span> possible responses (in the meat example, we have 5), then there will be <span class="math inline">\(k-1\)</span> thresholds. The area under the logistic density curve of each of the regions defined by those thresholds (there will be <span class="math inline">\(k\)</span> distinct regions) represents the probability of each possible response tied to that region.</p>
<p><img src="ordinal_files/figure-html/threshold-1.png" width="504"></p>
<div id="comparing-response-distributions-of-different-populations" class="section level3">
<h3 class="hasAnchor">
<a href="#comparing-response-distributions-of-different-populations" class="anchor"></a>Comparing response distributions of different populations</h3>
<p>In the cumulative logit model, the underlying assumption is that the odds ratio of one population relative to another is constant across all the possible responses. This means that all of the cumulative odds ratios are equal:</p>
<p><span class="math display">\[\small{\frac{codds(P(Resp = 1 | exposed))}{codds(P(Resp = 1 | unexposed))} = \frac{codds(P(Resp \leq 2 | exposed))}{codds(P(Resp \leq 2 | unexposed))} = \ ... \ = \frac{codds(P(Resp \leq 4 | exposed))}{codds(P(Resp \leq 4 | unexposed))}}\]</span></p>
<p>In terms of the underlying process, this means that each of the thresholds shifts the same amount (as shown below) where we add 1.1 units to each threshold that was set for the exposed group. What this effectively does is create a greater probability of a lower outcome for the unexposed group.</p>
<p><img src="ordinal_files/figure-html/plotB-1.png" width="504"></p>
</div>
<div id="the-cumulative-proportional-odds-model" class="section level3">
<h3 class="hasAnchor">
<a href="#the-cumulative-proportional-odds-model" class="anchor"></a>The cumulative proportional odds model</h3>
<p>In the <code>R</code> package <code>ordinal</code>, the model is fit using function <code>clm</code>. The model that is being estimated has the form</p>
<p><span class="math display">\[log \left( \frac{P(Resp \leq  i)}{P(Resp &gt; i)} | Group \right) = \alpha_i - \beta*I(Group=exposed) \  \ , \ i \in \{1, 2, 3, 4\}\]</span></p>
<p>The model specifies that the cumulative log-odds for a particular category is a function of two parameters, <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\beta\)</span>. (Note that in this parameterization and the model fit, <span class="math inline">\(-\beta\)</span> is used.) <span class="math inline">\(\alpha_i\)</span> represents the cumulative log odds of being in category <span class="math inline">\(i\)</span> or lower for those in the reference exposure group, which in our example is Group A. <em><span class="math inline">\(\alpha_i\)</span> also represents the threshold of the latent continuous (logistic) data generating process.</em> <span class="math inline">\(\beta\)</span> is the cumulative log-odds ratio for the category <span class="math inline">\(i\)</span> comparing the unexposed to reference group, which is the exposed. <em><span class="math inline">\(\beta\)</span> also represents the shift of the threshold on the latent continuous process for the exposed relative to the unexposed</em>. The proportionality assumption implies that the shift of the threshold for each of the categories is identical.</p>
</div>
<div id="simulation" class="section level3">
<h3 class="hasAnchor">
<a href="#simulation" class="anchor"></a>Simulation</h3>
<p>To generate ordered categorical data using <code>simstudy</code>, there is a function <code>genOrdCat</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">baseprobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.11</span>, <span class="fl">0.33</span>, <span class="fl">0.36</span>, <span class="fl">0.17</span>, <span class="fl">0.03</span><span class="op">)</span>

<span class="va">defA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/defDataAdd.html">defDataAdd</a></span><span class="op">(</span>varname <span class="op">=</span> <span class="st">"z"</span>, formula <span class="op">=</span> <span class="st">"-1.1*exposed"</span>, dist <span class="op">=</span> <span class="st">"nonrandom"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span>

<span class="va">dT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genData.html">genData</a></span><span class="op">(</span><span class="fl">25000</span><span class="op">)</span>
<span class="va">dT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trtAssign.html">trtAssign</a></span><span class="op">(</span><span class="va">dT</span>, grpName <span class="op">=</span> <span class="st">"exposed"</span><span class="op">)</span>
<span class="va">dT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/addColumns.html">addColumns</a></span><span class="op">(</span><span class="va">defA</span>, <span class="va">dT</span><span class="op">)</span>

<span class="va">dT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genOrdCat.html">genOrdCat</a></span><span class="op">(</span><span class="va">dT</span>, adjVar <span class="op">=</span> <span class="st">"z"</span>, <span class="va">baseprobs</span>, catVar <span class="op">=</span> <span class="st">"r"</span><span class="op">)</span></code></pre></div>
<p>Estimating the parameters of the model using function <code>clm</code>, we can recover the original parameters quite well.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/runehaubo/ordinal">ordinal</a></span><span class="op">)</span>
<span class="va">clmFit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ordinal/man/clm.html">clm</a></span><span class="op">(</span><span class="va">r</span> <span class="op">~</span> <span class="va">exposed</span>, data <span class="op">=</span> <span class="va">dT</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">clmFit</span><span class="op">)</span></code></pre></div>
<pre><code>## formula: r ~ exposed
## data:    dT
## 
##  link  threshold nobs  logLik    AIC      niter max.grad cond.H 
##  logit flexible  25000 -33223.00 66456.01 6(0)  8.24e-11 2.2e+01
## 
## Coefficients:
##         Estimate Std. Error z value Pr(&gt;|z|)    
## exposed  -1.1434     0.0241   -47.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Threshold coefficients:
##     Estimate Std. Error z value
## 1|2  -2.0938     0.0222   -94.5
## 2|3  -0.2614     0.0174   -15.1
## 3|4   1.3766     0.0205    67.2
## 4|5   3.4552     0.0456    75.8</code></pre>
<p>In the model output, the <code>exposed</code> coefficient of -1.15 is the estimate of <span class="math inline">\(-\beta\)</span> (i.e. <span class="math inline">\(\hat{\beta} = 1.15\)</span>), which was set to -1.1 in the simulation. The threshold coefficients are the estimates of the <span class="math inline">\(\alpha_i\)</span>’s in the model - and match the thresholds for the unexposed group.</p>
<p>The log of the cumulative odds for groups 1 to 4 from the data without exposure are</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">logOdds.unexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">dT</span><span class="op">[</span><span class="va">exposed</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##     1     2     3     4 
## -2.08 -0.26  1.36  3.43</code></pre>
<p>And under exposure:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">logOdds.expos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="fu">odds</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html">cumsum</a></span><span class="op">(</span><span class="va">dT</span><span class="op">[</span><span class="va">exposed</span> <span class="op">==</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code>##     1     2     3     4 
## -0.96  0.88  2.57  4.69</code></pre>
<p>The log of the cumulative odds ratios for each of the four groups is</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">logOdds.expos</span> <span class="op">-</span> <span class="va">logOdds.unexp</span></code></pre></div>
<pre><code>##   1   2   3   4 
## 1.1 1.1 1.2 1.3</code></pre>
</div>
<div id="correlated-multivariate-ordinal-data" class="section level3">
<h3 class="hasAnchor">
<a href="#correlated-multivariate-ordinal-data" class="anchor"></a>Correlated multivariate ordinal data</h3>
<p>Function <code>genOrdCat</code> generates multiple categorical response variables that may be correlated. For example, a survey of multiple Likert-type questions could have many response variables. The function generates correlated latent variables (using a normal copula) to simulate correlated categorical outcomes. The user specifies a matrix of probabilities, with each row representing a single item or categorical variable. The across each row must be 1. Adjustment variables can be specified for each item, or a single adjustment variable can be specified for all items. The correlation is on the standard normal scale and is specified with a value of <code>rho</code> and a correlation structure (<em>independence</em>, <em>compound symmetry</em>, or <em>AR-1</em>). Alternatively, a correlation matrix can be specified.</p>
<p>In this example, there are 5 questions, each of which has three possible responses: “none”, “some”, “a lot”. The probabilities of response are specified in a <span class="math inline">\(5 \times 3\)</span> matrix, and the rows sum to 1:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">baseprobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>,
                      <span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>,
                      <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>,
                      <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>,
                      <span class="fl">0.6</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>, 
                    nrow <span class="op">=</span> <span class="fl">5</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># generate the data</span>

<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">333</span><span class="op">)</span>                     
<span class="va">dT</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genData.html">genData</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">)</span>

<span class="va">dX</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genOrdCat.html">genOrdCat</a></span><span class="op">(</span><span class="va">dT</span>, adjVar <span class="op">=</span> <span class="cn">NULL</span>, baseprobs <span class="op">=</span> <span class="va">baseprobs</span>, 
                   prefix <span class="op">=</span> <span class="st">"q"</span>, rho <span class="op">=</span> <span class="fl">0.15</span>, corstr <span class="op">=</span> <span class="st">"cs"</span>, asFactor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>The observed correlation of the items is slightly less than the specified correlations as expected:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">q1</span>, <span class="va">q2</span>, <span class="va">q3</span>, <span class="va">q4</span>, <span class="va">q5</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##      q1   q2   q3   q4   q5
## q1 1.00 0.08 0.10 0.10 0.08
## q2 0.08 1.00 0.09 0.09 0.09
## q3 0.10 0.09 1.00 0.11 0.11
## q4 0.10 0.09 0.11 1.00 0.10
## q5 0.08 0.09 0.11 0.10 1.00</code></pre>
<p>However, the marginal probability distributions of each item match quite closely with the specified probabilities:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dM</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dX</span>, id.vars <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span>
<span class="va">dProp</span> <span class="op">&lt;-</span> <span class="va">dM</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">variable</span><span class="op">]</span>
<span class="va">dProp</span><span class="op">[</span>, <span class="va">response</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>

<span class="co"># observed probabilities</span>
<span class="fu">dcast</span><span class="op">(</span><span class="va">dProp</span>, <span class="va">variable</span> <span class="op">~</span> <span class="va">response</span>, value.var <span class="op">=</span> <span class="st">"V1"</span>, fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>##    variable    1    2    3
## 1:       q1 0.20 0.10 0.70
## 2:       q2 0.69 0.21 0.10
## 3:       q3 0.50 0.20 0.30
## 4:       q4 0.40 0.20 0.40
## 5:       q5 0.60 0.20 0.21</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># specified probabilites</span>
<span class="va">baseprobs</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]  0.2  0.1  0.7
## [2,]  0.7  0.2  0.1
## [3,]  0.5  0.2  0.3
## [4,]  0.4  0.2  0.4
## [5,]  0.6  0.2  0.2</code></pre>
<p>In the next example, the structure of the correlation is changed to AR-1, so the correlation between questions closer to each other is higher than for questions farther apart. But the probability distributions are unaffected:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dX</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/genOrdCat.html">genOrdCat</a></span><span class="op">(</span><span class="va">dT</span>, adjVar <span class="op">=</span> <span class="cn">NULL</span>, baseprobs <span class="op">=</span> <span class="va">baseprobs</span>, 
                   prefix <span class="op">=</span> <span class="st">"q"</span>, rho <span class="op">=</span> <span class="fl">0.40</span>, corstr <span class="op">=</span> <span class="st">"ar1"</span>, asFactor <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># correlation</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">dX</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">q1</span>, <span class="va">q2</span>, <span class="va">q3</span>, <span class="va">q4</span>, <span class="va">q5</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span><span class="op">)</span></code></pre></div>
<pre><code>##      q1   q2   q3   q4   q5
## q1 1.00 0.22 0.10 0.05 0.02
## q2 0.22 1.00 0.29 0.10 0.03
## q3 0.10 0.29 1.00 0.31 0.11
## q4 0.05 0.10 0.31 1.00 0.29
## q5 0.02 0.03 0.11 0.29 1.00</code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dM</span> <span class="op">&lt;-</span> <span class="fu">melt</span><span class="op">(</span><span class="va">dX</span>, id.vars <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span>
<span class="va">dProp</span> <span class="op">&lt;-</span> <span class="va">dM</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">prop.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="va">variable</span><span class="op">]</span>
<span class="va">dProp</span><span class="op">[</span>, <span class="va">response</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span>

<span class="co"># probabilities</span>
<span class="fu">dcast</span><span class="op">(</span><span class="va">dProp</span>, <span class="va">variable</span> <span class="op">~</span> <span class="va">response</span>, value.var <span class="op">=</span> <span class="st">"V1"</span>, fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<pre><code>##    variable    1    2     3
## 1:       q1 0.20 0.10 0.692
## 2:       q2 0.70 0.20 0.099
## 3:       q3 0.50 0.20 0.300
## 4:       q4 0.39 0.21 0.397
## 5:       q5 0.60 0.19 0.204</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.rdatagen.net/">Keith Goldfeld</a>, Jacob Wujciak-Jens.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
